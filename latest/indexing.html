<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Arrays: more advanced indexing · JuliaImages</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/default.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Ubuntu+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="assets/documenter.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="../versions.js"></script></head><body><nav class="toc"><h1>JuliaImages</h1><form class="search" action="search.html"><select id="version-selector" onChange="window.location.href=this.value"><option value="#" selected="selected" disabled="disabled">Version</option></select><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Home</a></li><li><a class="toctext" href="install.html">Getting started: Installation and testing your install</a></li><li><a class="toctext" href="quickstart.html">Quickstart</a></li><li><a class="toctext" href="arrays_colors.html">Arrays, Numbers, and Colors</a></li><li><a class="toctext" href="conversions_views.html">Conversions vs. views</a></li><li class="current"><a class="toctext" href="indexing.html">Arrays: more advanced indexing</a><ul class="internal"><li><a class="toctext" href="#Keeping-track-of-location-with-unconventional-indices-1">Keeping track of location with unconventional indices</a></li><li><a class="toctext" href="#Keeping-track-of-orientation-with-named-axes-1">Keeping track of orientation with named axes</a></li></ul></li><li><a class="toctext" href="imageaxes.html">ImageAxes.jl</a></li><li><a class="toctext" href="imagefiltering.html">ImageFiltering.jl</a></li><li><a class="toctext" href="imagemetadata.html">ImageMetadata.jl</a></li><li><a class="toctext" href="troubleshooting.html">Installation troubleshooting</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="indexing.html">Arrays: more advanced indexing</a></li></ul><a class="edit-page" href="https://github.com/JuliaImages/juliaimages.github.io/tree/44e0da5a072a26cee68aae80a0a4af9eb3cb8e43/docs/src/indexing.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/></header><h1><a class="nav-anchor" id="Arrays:-more-advanced-indexing-1" href="#Arrays:-more-advanced-indexing-1">Arrays: more advanced indexing</a></h1><p>In addition to the handling of numbers and colors, one of the main ways that JuliaImages leverages Julia is through a number of more sophisticated indexing operations. These are perhaps best illustrated with examples.</p><h2><a class="nav-anchor" id="Keeping-track-of-location-with-unconventional-indices-1" href="#Keeping-track-of-location-with-unconventional-indices-1">Keeping track of location with unconventional indices</a></h2><p>(<strong>Note: this depends on the not-yet-integrated ImageTransformations.jl</strong>)</p><p>Consider the following pair of images:</p><table><tr><th>col</th><th>col</th></tr><tr><td><img src="assets/indexing/cm.png" alt="cameraman"/></td><td><img src="assets/indexing/cmrot.png" alt="cameraman"/></td></tr></table><p>You might guess that the one on the right is a rotated version of the one on the left. But, what is the angle? Is there also a translation?</p><p>A &quot;low tech&quot; way to test this is to rotate and shift the image on the right until it seems aligned with the one on the left. We could overlay the two images (<a href="conversions_views.html#Using-colorview-to-make-color-overlays-1">Using colorview to make color overlays</a>) to see how well we&#39;re doing.</p><pre><code class="language-julia"># Define the transformation, using CoordinateTransformations
# We&#39;re rotating around the center of img
julia&gt; tfm = recenter(RotMatrix(pi/8), center(img))
AffineMap([0.92388 -0.382683; 0.382683 0.92388], [88.7786,-59.3199])

# Apply it to the image
julia&gt; imgrot = warp(img, tfm);

julia&gt; summary(img)
&quot;386×386 Array{Gray{N0f8},2}&quot;

julia&gt; summary(imgrot)
&quot;-59:446×-59:446 OffsetArray{Gray{Float64},2}&quot;</code></pre><p>While <code>img</code> has indices that start with the conventional 1, the summary of <code>imgrot</code> reports that it has indices <code>(-59:446, -59:446)</code>. This means that the first element of <code>imgrot</code> is indexed with <code>imgrot[-59,-59]</code> and the last element with <code>imgrot[446,446]</code>.</p><p>What is the meaning of these indices that extend beyond those of the original array in both directions? Displaying the rotated image–-especially when overlaid on the original–-reveals why:</p><pre><code class="language-julia"># Create a padded version of the original with the same indices as imgrot
julia&gt; img0 = similar(imgrot);

julia&gt; fill!(img0, 0);

# Copy the original image into the same index location
julia&gt; img0[1:386, 1:386] = img;  # or write as img0[indices(img)...] = img

# Create the overlay
julia&gt; imgov = colorview(RGB, img0, imgrot, zeroarray)</code></pre><p><img src="assets/indexing/rot_overlay.png" alt="rot_overlay"/></p><p>The padding on all sides of the array leaves space for the fact that the rotated image (green) contains some pixels out of the region covered by the original image (red).  The fact that Julia allows these indices to be <em>negative</em> means that we have no trouble adding appropriate &quot;padding&quot; to the original image: we just copy the original over to the padded array, using its original indices.</p><p>We can test whether this rotation aligns well with the original unrotated image at the top of this page:</p><pre><code class="language-julia">julia&gt; img0[indices(imgref)...] = imgref;  # imgref is the image on the left, top of page

julia&gt; imgov = colorview(RGB, img0, imgrot, zeroarray);</code></pre><p><img src="assets/indexing/ref_overlay.png" alt="ref_overlay"/></p><p>The fact that the overlapping portion looks yellow–-the combination of red and green–-indicates that we have perfect alignment.</p><p>You can learn more about Julia&#39;s support for arbitrary indices at ??. (<strong>to be written</strong>)</p><h2><a class="nav-anchor" id="Keeping-track-of-orientation-with-named-axes-1" href="#Keeping-track-of-orientation-with-named-axes-1">Keeping track of orientation with named axes</a></h2><p>Suppose you are presented with a 3-dimensional grayscale image. Is this a movie (2d over time), or a 3d image (x, y, and z)? In such situations, one of the best ways to keep yourself oriented is by naming the axes.</p><pre><code class="language-julia">julia&gt; using Images, TestImages

julia&gt; img = testimage(&quot;mri&quot;);

# Create a &quot;labeled image&quot;
julia&gt; imgl = AxisArray(img, :A, :R, :S)
3-dimensional AxisArray{ColorTypes.Gray{FixedPointNumbers.UFixed{UInt8,8}},3,...} with axes:
    :A, Base.OneTo(226)
    :R, Base.OneTo(186)
    :S, Base.OneTo(27)
And data, a 226×186×27 Array{ColorTypes.Gray{FixedPointNumbers.UFixed{UInt8,8}},3}:
[:, :, 1] =
 Gray{U8}(0.0)  Gray{U8}(0.0)  Gray{U8}(0.0)  Gray{U8}(0.0)  …  Gray{U8}(0.0)  Gray{U8}(0.0)  Gray{U8}(0.0)  Gray{U8}(0.0)
 Gray{U8}(0.0)  Gray{U8}(0.0)  Gray{U8}(0.0)  Gray{U8}(0.0)     Gray{U8}(0.0)  Gray{U8}(0.0)  Gray{U8}(0.0)  Gray{U8}(0.0)
...</code></pre><p>Here we used the <a href="https://github.com/JuliaArrays/AxisArrays.jl">AxisArrays package</a> to name our axes in terms of the <a href="http://www.grahamwideman.com/gw/brain/orientation/orientterms.htm">RAS coordinate system</a> (Right, Anterior, Superior) as commonly used in magnetic resonance imaging.</p><p>We can use this coordinate system to help with visualization. Let&#39;s look at a &quot;horizontal slice,&quot; one perpendicular to the superior-inferior axis (i.e., a slice with constant <code>S</code> value):</p><p><img src="assets/indexing/mri_s_slice.png" alt="Sslice"/></p><p>From the summary you can see that the slice has just the <code>:A</code> and <code>:R</code> axes remaining.</p><p>We could slice along the <code>R</code> and <code>A</code> axes too, although for this image (which is sampled very anisotropically) they are not as informative.</p><p>The <a href="https://github.com/JuliaImages/ImageAxes.jl">ImageAxes</a> and <a href="https://github.com/JuliaImages/ImageMetadata.jl">ImageMetadata</a> packages add additional functionality to AxisArrays that may be useful when you need to encode more information about your image.</p><footer><hr/><a class="previous" href="conversions_views.html"><span class="direction">Previous</span><span class="title">Conversions vs. views</span></a><a class="next" href="imageaxes.html"><span class="direction">Next</span><span class="title">ImageAxes.jl</span></a></footer></article></body></html>
